# Assess Access to VPN Connections

|ID          |
|------------|
|CHSTG-POST-06|

## Summary

Once an attacker has achieved local administrative access and can authenticate into the operating system, the next objective is often lateral movement or remote network access. Virtual Private Network (VPN) clients installed on the workstation frequently store configuration profiles, certificates, or even cached credentials that can be exploited to bridge the gap between the compromised hardware and the internal corporate network. This control evaluates whether an unauthorized user can utilize existing VPN setups to gain further access to sensitive internal resources.

## Test Objectives
- Identify installed VPN software and existing connection profiles.
- Determine if VPN connections can be established without additional user-specific secrets (e.g., passwords or MFA).
- Attempt to retrieve sensitive connection materials such as certificates, tokens, or configuration files.

## How to Test
This test is conducted on the live system after establishing a local administrator account (refer to **CHSTG-POST-02**) and successfully logging into the OS.

### Prerequisites
- A successful login to the target OS with administrative privileges.
- No internal physical disassembly is required for this software-level assessment.

### Execution Steps
1.  **Identify VPN Clients**: Scan the system for common enterprise VPN clients such as Cisco AnyConnect, Palo Alto GlobalProtect, FortiClient, or OpenVPN.
2.  **Locate Configuration Data**:
    * **Windows**: Check `%AppData%`, `%ProgramData%`, and the Registry for connection profiles, XML configuration files, and saved certificates.
    * **Linux**: Inspect `/etc/openvpn/`, `~/.config/`, or NetworkManager profiles in `/etc/NetworkManager/system-connections/`.
3.  **Attempt Connection**: Launch the VPN client and attempt to initiate a connection using the existing profiles.
    * **Observation**: Does the client automatically fill in credentials? Is the connection established without further interaction?
4.  **Credential Retrieval**: Use specialized tools (e.g., Mimikatz or browser credential dumpers) to check if VPN passwords or tokens are cached in the system's memory or credential manager.

### Success Criteria
* **FAILED**: A VPN connection is successfully established, or sensitive configuration material/credentials are recovered that allow for remote network access.

## Remediation
If the workstation's local security has already been compromised, the VPN's security depends entirely on its own authentication stack:
- **Enforce Multi-Factor Authentication (MFA)**: Require a second factor (e.g., TOTP, Push notification, or FIDO2 key) for every VPN connection attempt to ensure that local access does not grant network access.
- **Disable Credential Caching**: Configure VPN policies to never save user passwords locally on the disk or in the system's credential vault.
- **Certificate Security**: Use hardware-backed storage for VPN certificates (e.g., TPM or Smart Cards) to prevent them from being exported from the filesystem.
- **Context-Aware Access**: Implement "Zero Trust" policies that verify the device's health and integrity before allowing a VPN tunnel to be established.