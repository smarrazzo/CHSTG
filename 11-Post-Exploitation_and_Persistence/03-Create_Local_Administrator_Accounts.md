# Create Local Administrator Accounts

|ID          |
|------------|
|CHSTG-POST-02|

## Summary

Once a privileged shell (NT AUTHORITY\SYSTEM or root) is obtained through hardware exploitation (DMA) or offline manipulation, the creation of a local administrator account is a primary method for ensuring persistent and "legitimate-looking" access. This allows an attacker to log in normally without re-exploiting hardware vulnerabilities, effectively bypassing subsequent authentication barriers.

## Test Objectives
- Demonstrate the ability to leverage a privileged shell to create unauthorized administrative accounts.
- Verify that the newly created account has full administrative/root privileges.
- Assess whether the creation of such accounts triggers security alerts or is blocked by endpoint protection.

## How to Test
This test is performed using a privileged shell obtained in previous stages of the audit (e.g., via DMA injection or after decrypting the disk).

### Prerequisites
- A shell with **NT AUTHORITY\SYSTEM** (Windows) or **root** (Linux) privileges.
- No internal physical access is required for this software-level step.

### Execution Steps

#### Windows (Command Prompt/PowerShell)
1. **Create the user account**:
   `net user admin-hacker SuperPassword1! /add`
2. **Assign administrative privileges**:
   `net localgroup administrators admin-hacker /add`
3. **Verification**: Attempt to log in with the new credentials or run `net localgroup administrators` to confirm the account is listed.

#### Linux (Terminal)
1. **Create the user account and home directory**:
   `useradd -m -s /bin/bash admin-hacker`
2. **Set the password**:
   `echo "admin-hacker:SuperPassword1!" | chpasswd`
3. **Assign root privileges (via sudo or wheel group)**:
   - On Debian/Ubuntu: `usermod -aG sudo admin-hacker`
   - On RHEL/CentOS: `usermod -aG wheel admin-hacker`
4. **Verification**: Switch to the new user and verify root access: `su - admin-hacker` then `sudo whoami`.

## Remediation
As noted, if the initial hardware or disk protections have failed, there is no direct hardware remediation to prevent account creation.