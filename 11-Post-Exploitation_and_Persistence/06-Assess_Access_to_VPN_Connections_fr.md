# Évaluer l'accès aux connexions VPN

|ID          |
|------------|
|CHSTG-POST-06|

## Résumé

Une fois qu'un attaquant a obtenu un accès administratif local et peut s'authentifier dans le système d'exploitation, l'objectif suivant est souvent le mouvement latéral ou l'accès réseau à distance. Les clients VPN (réseau privé virtuel) installés sur la station de travail stockent fréquemment des profils de configuration, des certificats ou même des identifiants en cache qui peuvent être exploités pour combler le fossé entre le matériel compromis et le réseau d'entreprise interne. Ce contrôle évalue si un utilisateur non autorisé peut utiliser les configurations VPN existantes pour obtenir un accès supplémentaire aux ressources internes sensibles.

## Objectifs du test
- Identifier les logiciels VPN installés et les profils de connexion existants.
- Déterminer si les connexions VPN peuvent être établies sans secrets spécifiques à l'utilisateur supplémentaires (ex. mots de passe ou MFA).
- Tenter de récupérer du matériel de connexion sensible tel que certificats, jetons ou fichiers de configuration.

## Comment tester
Ce test est réalisé sur le système en fonctionnement après avoir établi un compte administrateur local (voir **CHSTG-POST-02**) et s'être connecté avec succès au système d'exploitation.

### Prérequis
- Une connexion réussie au système d'exploitation cible avec des privilèges administratifs.
- Aucun démontage physique interne n'est requis pour cette évaluation au niveau logiciel.

### Étapes d'exécution
1.  **Identifier les clients VPN :** Scanner le système pour les clients VPN d'entreprise courants tels que Cisco AnyConnect, Palo Alto GlobalProtect, FortiClient ou OpenVPN.
2.  **Localiser les données de configuration :**
    * **Windows :** Vérifier `%AppData%`, `%ProgramData%` et le registre pour les profils de connexion, fichiers de configuration XML et certificats enregistrés.
    * **Linux :** Inspecter `/etc/openvpn/`, `~/.config/` ou les profils NetworkManager dans `/etc/NetworkManager/system-connections/`.
3.  **Tentative de connexion :** Lancer le client VPN et tenter d'initier une connexion en utilisant les profils existants.
    * **Observation :** Le client remplit-il automatiquement les identifiants ? La connexion est-elle établie sans interaction supplémentaire ?
4.  **Récupération des identifiants :** Utiliser des outils spécialisés (ex. Mimikatz ou extracteurs d'identifiants de navigateur) pour vérifier si les mots de passe ou jetons VPN sont en cache dans la mémoire du système ou le gestionnaire d'identifiants.

### Critère de succès
* **ÉCHEC :** Une connexion VPN est établie avec succès, ou du matériel de configuration/identifiants sensibles est récupéré permettant l'accès réseau à distance.

## Remédiation
Si la sécurité locale de la station de travail a déjà été compromise, la sécurité du VPN dépend entièrement de sa propre pile d'authentification :
- **Appliquer l'authentification multifacteur (MFA) :** Exiger un second facteur (ex. TOTP, notification Push ou clé FIDO2) pour chaque tentative de connexion VPN pour garantir que l'accès local n'accorde pas l'accès réseau.
- **Désactiver la mise en cache des identifiants :** Configurer les politiques VPN pour ne jamais enregistrer les mots de passe utilisateur localement sur le disque ou dans le coffre-fort d'identifiants du système.
- **Sécurité des certificats :** Utiliser un stockage matériel pour les certificats VPN (ex. TPM ou cartes à puce) pour empêcher leur exportation depuis le système de fichiers.
- **Accès contextuel :** Mettre en œuvre des politiques « Zero Trust » qui vérifient l'intégrité et l'état du dispositif avant d'autoriser l'établissement d'un tunnel VPN.
